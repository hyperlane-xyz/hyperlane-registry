#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# If not in GitHub Actions, check for potential secrets in staged files
if [ "$GITHUB_ACTIONS" != "true" ]; then
    echo "ğŸ” Checking for potential secrets in staged files..."
    if git diff --cached --name-only | xargs gitleaks protect --staged --verbose --redact --config .gitleaks.toml; then
        echo "âœ… No secrets detected"
    else
        echo "âŒ Potential secrets detected in your changes!"
        echo "Please remove any secrets, credentials, or sensitive information before committing."
        exit 1
    fi
fi

yarn lint-staged